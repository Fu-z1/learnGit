inherit: [buildenv]

metaEnvironment:
   PKG_RESPONSIBLE: "Navigation-Kartendarstellung"

environment:
   MACGYDANCE: "${MACGYDANCE:-0}"

depends:
  - hmi::ext-harfbuzz-dev
  - hmi::ext-freetype-dev
  - navigation::ext-glm-dev
  - navigation::ext-tinyxml-dev
  - navigation::tsd-nav-crypto-api-dev
  - navigation::tsd-nav-mapdisplay-bridge-dev
  - navigation::tsd-nav-middleware-interface-dev
  - navigation::tsd-nav-sdk-common-api-dev
  - navigation::tsd-nav-sdk-mapdataservice-dev
  - navigation::tsd-nav-sdk-mapdataservice-api-dev
  - navigation::tsd-nav-sdk-mapdisplay-api-dev
  - navigation::tsd-nav-sdk-mapdisplay-dev
  - navigation::tsd-nav-sdk-namebuilder-dev
  - navigation::tsd-nav-utils-dev
  - navigation::tsd-nav-sdk-imageservices-dev
  - libs::tsd-rasterimage-dev
  - system::tsd-common-dev
  - if: "$(ne,${MACGYDANCE:-0},0)"
    depends:
      - navigation::tsd-nav-sdk-pathfinder-dev
      - navigation::tsd-nav-traffic-dev
   # TODO: TARGET system::ext-opengles-target

checkoutSCM:
   scm: git
   url: git@${DEFAULT_PCC_GIT_SERVER}:mib3-navigation/tsd.nav.mapgyver.git
   dir: tsd.nav.mapgyver
   branch: master       #navi-tool (not a part of the release)

buildVars: [MACGYDANCE]
buildScript: |
   buildenvBuildAll -DTSD_BUILDENV_INSTALLABLE_APP_TARGETS=1 -DTSD_BUILDENV_ENABLE_APP_TARGETS=1 \
                    -DMACGYDANCE=${MACGYDANCE:-0}
   mkdir -p dist/usr/bin
   rsync -a --delete $1/tsd.nav.mapgyver/app/mapgyver/ini dist/usr/bin/
   rsync -a --delete $1/tsd.nav.mapgyver/app/mapgyver/gpx dist/usr/bin/
   rsync -a --delete $1/tsd.nav.mapgyver/app/mapgyver/res dist/usr/bin/
   rsync -a --delete $1/tsd.nav.mapgyver/app/mapgyver/themes dist/usr/bin/

multiPackage:
   target: # Executable
      packageScript: |
         buildenvPackageTarget
