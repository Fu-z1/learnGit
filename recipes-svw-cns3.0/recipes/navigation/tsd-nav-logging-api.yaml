inherit: [buildenv, packing-module]

metaEnvironment:
   PKG_RESPONSIBLE: "Navigation-System"

checkoutSCM:
  - scm: git
    url: git@${DEFAULT_PCC_GIT_SERVER}:mib3-navigation/tsd.nav.logging.api.git
    dir: tsd.nav.logging.api
    tag: mqb_sop1_eu-v1.0.1   #navi-interface (interface to externel contractors)
      # see link for change prozess: https://wiki-automotive.server.technisat-digital/display/MIB3SERIE/Schnittstellen+Navigation

# currently no dependencies

buildScript: buildenvBuildAll

multiPackage:
  ? ""
  :
     inherit: [navi_compflags_werror_sanitize]
     multiPackage:
        dev:
           packageScript: buildenvPackageDev

        target: # Shared-lib
           packageScript: |
              buildenvPackageTarget
              d=$(mktemp -d)
              rsync -a --delete --exclude ".debug" ./ $d
              buildSwupModule -n "nav-logging-api" \
                 -p "emmc.navigation" \
                 -o "navigation:tsd-nav-logging-api " -f $d -- \
                 -U "Partition=rootfs_ro"
              rm -rf $d
